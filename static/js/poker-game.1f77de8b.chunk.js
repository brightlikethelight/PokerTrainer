"use strict";(self.webpackChunkpoker_trainer=self.webpackChunkpoker_trainer||[]).push([[53],{656(t,e,a){a.r(e),a.d(e,{default:()=>C});var i=a(43),s=a(555),n=a(442),r=a(780),l=a(959);const o=class{constructor(){this.cards=[],this.dealtCards=[],this.reset()}reset(){this.cards=[],this.dealtCards=[];for(const t of Object.values(n.J0))for(const e of Object.values(n.G2))this.cards.push(new l.A(e,t));this.shuffle()}shuffle(){const t=t=>{if("undefined"!==typeof crypto&&crypto.getRandomValues){const e=new Uint32Array(1);return crypto.getRandomValues(e),Math.floor(e[0]/4294967296*t)}return Math.floor(Math.random()*t)};for(let e=this.cards.length-1;e>0;e--){const a=t(e+1);[this.cards[e],this.cards[a]]=[this.cards[a],this.cards[e]]}}dealCard(){if(0===this.cards.length)throw new Error("Not enough cards in deck");const t=this.cards.shift();return this.dealtCards.push(t),t}dealOne(){return this.dealCard()}dealCards(t){if(t<0)throw new Error("Cannot deal negative number of cards");if(t>this.cards.length)throw new Error("Not enough cards in deck");const e=[];for(let a=0;a<t;a++)e.push(this.dealCard());return e}deal(t){return this.dealCards(t)}cardsRemaining(){return this.cards.length}getRemainingCards(){return this.cardsRemaining()}getDealtCards(){return[...this.dealtCards]}removeSpecificCards(t){this.cards=this.cards.filter(e=>!t.some(t=>e.rank===t.rank&&e.suit===t.suit))}};const c=class{constructor(){this.players=[],this.deck=null,this.communityCards=[],this._internalPot={main:0,side:[]},this.potHistory=[],this.currentBet=0,this._currentBet=0,this.minimumRaise=0,this.minRaise=0,this.dealerPosition=0,this.smallBlindPosition=1,this.bigBlindPosition=2,this.currentPlayerIndex=0,this.phase=n.aA.WAITING,this.handNumber=0,this.blinds={small:10,big:20},this.lastRaiserIndex=null,this.bettingRoundComplete=!1,this.handHistory=[],this.winners=[]}initialize(t){this.players=t,this.dealerPosition=0,2===t.length?(this.smallBlindPosition=0,this.bigBlindPosition=1,this.currentPlayerIndex=0):(this.smallBlindPosition=1,this.bigBlindPosition=2,this.currentPlayerIndex=3),this._internalPot={main:0,side:[]},this.potHistory=[],this.currentBet=0,this._currentBet=0,this.minimumRaise=0,this.minRaise=0,this.phase=n.aA.PREFLOP}validateState(){return!(!this.players||this.players.length<2)&&(!(this.dealerPosition<0||this.dealerPosition>=this.players.length)&&!(this.currentPlayerIndex<0||this.currentPlayerIndex>=this.players.length))}addPlayer(t){this.players.push(t),t.position=this.players.length-1}removePlayer(t){this.players=this.players.filter(e=>e.id!==t),this.updatePlayerPositions()}updatePlayerPositions(){this.players.forEach((t,e)=>{t.position=e})}getActivePlayers(){return this.players.filter(t=>t.isActive&&(t.chips>0||t.status===n.PQ.ALL_IN)&&t.status!==n.PQ.FOLDED&&t.status!==n.PQ.SITTING_OUT)}getPlayersInHand(){return this.players.filter(t=>t.isInHand())}getNextActivePlayerIndex(t){if(!this.players||0===this.players.length)return-1;const e=this.players.length;let a=(t+1)%e;for(let i=0;i<e;i++){const t=this.players[a];if(t&&t.canAct())return a;a=(a+1)%e}return-1}moveButton(){for(this.dealerPosition=(this.dealerPosition+1)%this.players.length;0===this.players[this.dealerPosition].chips;)this.dealerPosition=(this.dealerPosition+1)%this.players.length}getSmallBlindPosition(){if(2===this.players.length)return this.dealerPosition;let t=(this.dealerPosition+1)%this.players.length;for(;0===this.players[t].chips;)t=(t+1)%this.players.length;return t}getBigBlindPosition(){let t=(this.getSmallBlindPosition()+1)%this.players.length;for(;0===this.players[t].chips;)t=(t+1)%this.players.length;return t}getUTGPosition(){let t=(this.getBigBlindPosition()+1)%this.players.length;for(;0===this.players[t].chips;)t=(t+1)%this.players.length;return t}resetForNewHand(){this.communityCards=[],this._internalPot={main:0,side:[]},this.potHistory=[],this.currentBet=0,this._currentBet=0,this.minimumRaise=this.blinds.big,this.minRaise=this.blinds.big,this.phase=n.aA.PREFLOP,this.lastRaiserIndex=null,this.bettingRoundComplete=!1,this.winners=[],this.handNumber++,this.players.forEach(t=>{t.chips>0?t.resetForNewHand():t.status=n.PQ.SITTING_OUT})}calculateSidePots(){const t=this.getPlayersInHand();if(0===t.length)return;const e=[];t.forEach(t=>{t.totalPotContribution>0&&e.push({player:t,amount:t.totalPotContribution})}),e.sort((t,e)=>t.amount-e.amount),this._internalPot={main:0,side:[]};let a=0;for(let i=0;i<e.length;i++){const t=e[i].amount,s=(t-a)*(e.length-i);if(0===i)this._internalPot.main=s;else{const t=e.slice(i).map(t=>t.player);this._internalPot.side.push({amount:s,eligiblePlayers:t})}a=t}}getTotalPot(){let t=this._internalPot.main;return this._internalPot.side.forEach(e=>{t+=e.amount}),t}addToHistory(t){this.handHistory.push({handNumber:this.handNumber,phase:this.phase,_action:t,timestamp:Date.now()})}getPlayerByPosition(t){return this.players.find(e=>e.position===t)}serialize(){return{players:this.players.map(t=>t.serialize()),communityCards:this.communityCards.map(t=>({rank:t.rank,suit:t.suit})),pot:this._internalPot,_pot:this._internalPot.main,currentBet:this.currentBet,minimumRaise:this.minimumRaise,dealerPosition:this.dealerPosition,currentPlayerIndex:this.currentPlayerIndex,phase:this.phase,handNumber:this.handNumber,blinds:this.blinds,totalPot:this.getTotalPot(),playersInHand:this.getPlayersInHand().length,winners:this.winners,getTotalPot:()=>this.getTotalPot(),getPlayersInHand:()=>this.getPlayersInHand(),getActivePlayers:()=>this.getActivePlayers(),getSmallBlindPosition:()=>this.getSmallBlindPosition(),getBigBlindPosition:()=>this.getBigBlindPosition(),getPlayerByPosition:t=>this.getPlayerByPosition(t)}}get pot(){const t=this,e=this._internalPot.main;return{valueOf:()=>e,toString:()=>e.toString(),[Symbol.toPrimitive]:t=>e,get main(){return t._internalPot.main},set main(e){t._internalPot.main=e}}}set pot(t){"number"===typeof t?this._internalPot.main=t:this._internalPot=t}get _pot(){return this._internalPot.main}set _pot(t){this._internalPot="number"===typeof t?{main:t,side:[]}:t}get potObject(){return this._internalPot}nextDealer(){for(this.dealerPosition=(this.dealerPosition+1)%this.players.length;0===this.players[this.dealerPosition].chips||!this.players[this.dealerPosition].isActive;)this.dealerPosition=(this.dealerPosition+1)%this.players.length;2===this.players.length?(this.smallBlindPosition=this.dealerPosition,this.bigBlindPosition=(this.dealerPosition+1)%this.players.length):(this.smallBlindPosition=(this.dealerPosition+1)%this.players.length,this.bigBlindPosition=(this.dealerPosition+2)%this.players.length)}addToPot(t){this._internalPot.main+=t,this.potHistory.push(t)}setCurrentBet(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.currentBet=t,this._currentBet=t,this.minimumRaise=e,this.minRaise=e}nextPhase(){const t=[n.aA.PREFLOP,n.aA.FLOP,n.aA.TURN,n.aA.RIVER,n.aA.SHOWDOWN],e=t.indexOf(this.phase);e<t.length-1&&(this.phase=t[e+1]),this.currentBet=0,this._currentBet=0,this.minimumRaise=0,this.minRaise=0}setCommunityCards(t){this.communityCards=t}nextPlayer(){this.currentPlayerIndex=this.getNextActivePlayerIndex(this.currentPlayerIndex)}getCurrentPlayer(){return this.players[this.currentPlayerIndex]}isHandComplete(){if(this.phase===n.aA.SHOWDOWN)return!0;return this.getPlayersInHand().length<=1}createSidePots(){const t=this.getPlayersInHand();if(0===t.length)return[];const e=[];t.forEach(t=>{const a=t.currentBet||t._currentBet||0;a>0&&e.push({player:t,amount:a})}),e.sort((t,e)=>t.amount-e.amount);const a=[];let i=0;for(let s=0;s<e.length;s++){const t=e[s].amount,n=(t-i)*(e.length-s);if(n>0){const t=e.slice(s).map(t=>t.player);a.push({amount:n,eligiblePlayers:t})}i=t}return a}isBettingRoundComplete(){const t=this.getActivePlayers().filter(t=>t.canAct());if(t.length<=1)return!0;const e=t.filter(t=>t.status!==n.PQ.FOLDED&&t.status!==n.PQ.ALL_IN);if(0===e.length)return!0;const a=e.map(t=>t._currentBet);return a.every(t=>t===a[0])&&e.every(t=>null!==t.lastAction)}toJSON(){return this.serialize()}};const h=class{static evaluateHand(t){if(t.length<5)throw new Error("Need at least 5 cards to evaluate");const e=this.getCombinations(t,5);let a=null,i=-1,s=[];for(const n of e){const t=this.evaluateFiveCardHand(n);(t.rank>i||t.rank===i&&this.compareTiebreakers(t.tiebreakers,s)>0)&&(i=t.rank,s=t.tiebreakers,a={rank:t.rank,rankName:t.rankName,cards:n,tiebreakers:t.tiebreakers,description:t.description})}return a}static evaluateFiveCardHand(t){const e=[...t].sort((t,e)=>e.value-t.value),a=this.checkFlush(t),i=this.checkStraight(e),s=this.groupByRank(t),r=Object.values(s).map(t=>t.length).sort((t,e)=>e-t);if(a&&i)return 14===i?{rank:n.mf.ROYAL_FLUSH,rankName:"Royal Flush",tiebreakers:[],description:"Royal Flush"}:{rank:n.mf.STRAIGHT_FLUSH,rankName:"Straight Flush",tiebreakers:[i],description:"Straight Flush, ".concat(this.getCardName(i)," high")};if(4===r[0]){const t=this.getRankOfSize(s,4),e=this.getRankOfSize(s,1);return{rank:n.mf.FOUR_OF_A_KIND,rankName:"Four of a Kind",tiebreakers:[t,e],description:"Four of a Kind, ".concat(this.getCardName(t),"s")}}if(3===r[0]&&2===r[1]){const t=this.getRankOfSize(s,3),e=this.getRankOfSize(s,2);return{rank:n.mf.FULL_HOUSE,rankName:"Full House",tiebreakers:[t,e],description:"Full House, ".concat(this.getCardName(t),"s full of ").concat(this.getCardName(e),"s")}}if(a){const t=e.map(t=>t.value);return{rank:n.mf.FLUSH,rankName:"Flush",tiebreakers:t,description:"Flush, ".concat(this.getCardName(t[0])," high")}}if(i)return{rank:n.mf.STRAIGHT,rankName:"Straight",tiebreakers:[i],description:"Straight, ".concat(this.getCardName(i)," high")};if(3===r[0]){const t=this.getRankOfSize(s,3),e=this.getKickers(s,[t],2);return{rank:n.mf.THREE_OF_A_KIND,rankName:"Three of a Kind",tiebreakers:[t,...e],description:"Three of a Kind, ".concat(this.getCardName(t),"s")}}if(2===r[0]&&2===r[1]){const t=this.getRanksOfSize(s,2).sort((t,e)=>e-t),e=this.getKickers(s,t,1)[0];return{rank:n.mf.TWO_PAIR,rankName:"Two Pair",tiebreakers:[...t,e],description:"Two Pair, ".concat(this.getCardName(t[0]),"s and ").concat(this.getCardName(t[1]),"s")}}if(2===r[0]){const t=this.getRankOfSize(s,2),e=this.getKickers(s,[t],3);return{rank:n.mf.PAIR,rankName:"Pair",tiebreakers:[t,...e],description:"Pair of ".concat(this.getCardName(t),"s")}}const l=e.map(t=>t.value).slice(0,5);return{rank:n.mf.HIGH_CARD,rankName:"High Card",tiebreakers:l,description:"High Card, ".concat(this.getCardName(l[0]))}}static checkFlush(t){const e={};for(const a of t)e[a.suit]=(e[a.suit]||0)+1;return Object.values(e).some(t=>t>=5)}static checkStraight(t){const e=t.map(t=>t.value);for(let a=0;a<=e.length-5;a++){let t=!0;for(let i=0;i<4;i++)if(e[a+i]-e[a+i+1]!==1){t=!1;break}if(t)return e[a]}return 14===e[0]&&5===e[e.length-4]&&4===e[e.length-3]&&3===e[e.length-2]&&2===e[e.length-1]?5:null}static groupByRank(t){const e={};for(const a of t)e[a.value]||(e[a.value]=[]),e[a.value].push(a);return e}static getRankOfSize(t,e){for(const[a,i]of Object.entries(t))if(i.length===e)return parseInt(a);return null}static getRanksOfSize(t,e){const a=[];for(const[i,s]of Object.entries(t))s.length===e&&a.push(parseInt(i));return a}static getKickers(t,e,a){const i=[],s=Object.keys(t).map(t=>parseInt(t)).filter(t=>!e.includes(t)).sort((t,e)=>e-t);for(let n=0;n<a&&n<s.length;n++)i.push(s[n]);return i}static compareTiebreakers(t,e){for(let a=0;a<Math.min(t.length,e.length);a++){if(t[a]>e[a])return 1;if(t[a]<e[a])return-1}return 0}static getCardName(t){return{2:"Two",3:"Three",4:"Four",5:"Five",6:"Six",7:"Seven",8:"Eight",9:"Nine",10:"Ten",11:"Jack",12:"Queen",13:"King",14:"Ace"}[t]||t.toString()}static getCombinations(t,e){const a=[];return function i(s,n){if(n.length!==e)for(let e=s;e<t.length;e++)n.push(t[e]),i(e+1,n),n.pop();else a.push([...n])}(0,[]),a}static compareHands(t,e){return t.rank>e.rank?1:t.rank<e.rank?-1:this.compareTiebreakers(t.tiebreakers,e.tiebreakers)}static findWinners(t){const e=t.map(t=>{let{player:e,cards:a}=t;return{player:e,hand:this.evaluateHand(a)}});e.sort((t,e)=>this.compareHands(e.hand,t.hand));const a=[e[0]];for(let i=1;i<e.length&&0===this.compareHands(e[0].hand,e[i].hand);i++)a.push(e[i]);return a}};var d=a(771);const u=class{constructor(){this.gameState=new c,this.deck=new o,this.gameState.deck=this.deck,this._isRestarting=!1,this._isInitialized=!1,this.callbacks={onStateChange:null,onHandComplete:null,onPlayerAction:null,onPhaseChange:null,onShowdown:null}}setCallback(t,e){Object.prototype.hasOwnProperty.call(this.callbacks,t)&&(this.callbacks[t]=e)}addPlayer(t){this.gameState.addPlayer(t),this.notifyStateChange()}removePlayer(t){this.gameState.removePlayer(t),this.notifyStateChange()}startNewHand(){try{if(this._isRestarting)return;if(this.gameState.resetForNewHand(),this.gameState.getActivePlayers().length<2)throw new Error("Need at least 2 players to start a hand");if(this.gameState.moveButton(),this.deck.reset(),this.deck.cardsRemaining()<20)throw new Error("Deck has insufficient cards");this.postBlinds(),this.dealHoleCards(),this.gameState.currentPlayerIndex=this.gameState.getUTGPosition(),this.notifyStateChange(),this.notifyPhaseChange()}catch(t){throw this._isRestarting=!1,t}}postBlinds(){const t=this.gameState.getSmallBlindPosition(),e=this.gameState.getBigBlindPosition(),a=this.gameState.getPlayerByPosition(t),i=this.gameState.getPlayerByPosition(e);if(a&&a.chips>0){const t=Math.min(this.gameState.blinds.small,a.chips);a.placeBet(t),this.gameState._internalPot.main+=t,this.gameState.addToHistory({playerId:a.id,playerName:a.name,_action:"small-blind",amount:t})}if(i&&i.chips>0){const t=Math.min(this.gameState.blinds.big,i.chips);i.placeBet(t),this.gameState._internalPot.main+=t,this.gameState.currentBet=t,this.gameState.addToHistory({playerId:i.id,playerName:i.name,_action:"big-blind",amount:t})}}dealHoleCards(){const t=this.gameState.getActivePlayers();for(let e=0;e<2;e++)for(const a of t){const t=this.deck.dealCard();a.holeCards.push(t)}}dealCommunityCards(t){const e=this.deck.dealCards(t);this.gameState.communityCards.push(...e),this.notifyStateChange()}executePlayerAction(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;try{if(!this.gameState||!this.gameState.players)throw new Error("Game state not initialized");const i=this.gameState.players.find(e=>e&&e.id===t);if(!i)throw console.error("Available players:",this.gameState.players.map(t=>t?t.id:"null")),new Error("Player with ID '".concat(t,"' not found in game"));if(!i.canAct())throw new Error("Player '".concat(i.name,"' cannot act (status: ").concat(i.status,")"));const s=this.gameState.players[this.gameState.currentPlayerIndex];if(!s)throw new Error("No current player at index ".concat(this.gameState.currentPlayerIndex));if(s.id!==t)throw new Error("Not ".concat(i.name,"'s turn (current: ").concat(s.name,")"));return d.A.executeAction(this.gameState,i,e,a),this.callbacks.onPlayerAction&&this.callbacks.onPlayerAction(i,e,a),this.checkAndAdvanceGame(),{success:!0,action:e,amount:a,playerId:t}}catch(r){var i,s,n;return console.error("GameEngine executePlayerAction error:",{playerId:t,_action:e,amount:a,gameStateExists:!!this.gameState,playersCount:(null===(i=this.gameState)||void 0===i||null===(s=i.players)||void 0===s?void 0:s.length)||0,currentPlayerIndex:null===(n=this.gameState)||void 0===n?void 0:n.currentPlayerIndex,error:r.message}),{success:!1,error:r.message,action:e,amount:a,playerId:t}}}checkAndAdvanceGame(){if(1===this.gameState.getActivePlayers().length)return void this.handleSinglePlayerWin();const t=this.gameState.getPlayersInHand();if(1===t.length)return void this.handleSinglePlayerWin();if(0===t.length)return this.gameState.phase="waiting",void this.notifyStateChange();if(0===this.gameState.players.filter(t=>t.canAct()).length&&t.length>=2)for(;this.gameState.phase!==n.aA.SHOWDOWN;)this.advanceToNextPhase();else d.A.isBettingRoundComplete(this.gameState)?this.advanceToNextPhase():this.moveToNextPlayer(),this.notifyStateChange()}moveToNextPlayer(){if(this.gameState.players.filter(t=>t.canAct()).length<=1)for(;this.gameState.phase!==n.aA.SHOWDOWN;)this.advanceToNextPhase();else this.gameState.currentPlayerIndex=this.gameState.getNextActivePlayerIndex(this.gameState.currentPlayerIndex),-1===this.gameState.currentPlayerIndex&&this.advanceToNextPhase()}advanceToNextPhase(){switch(this.resetBettingRound(),this.gameState.phase){case n.aA.PREFLOP:this.gameState.phase=n.aA.FLOP,this.dealCommunityCards(3);break;case n.aA.FLOP:this.gameState.phase=n.aA.TURN,this.dealCommunityCards(1);break;case n.aA.TURN:this.gameState.phase=n.aA.RIVER,this.dealCommunityCards(1);break;case n.aA.RIVER:return void this.handleShowdown()}const t=this.gameState.dealerPosition;if(this.gameState.currentPlayerIndex=this.gameState.getNextActivePlayerIndex(t),-1===this.gameState.currentPlayerIndex){if(this.gameState.getPlayersInHand().length>=2)return void this.advanceToNextPhase()}this.notifyPhaseChange(),this.notifyStateChange()}resetBettingRound(){this.gameState.currentBet=0,this.gameState.minimumRaise=this.gameState.blinds.big,this.gameState.lastRaiserIndex=null,this.gameState.players.forEach(t=>{t._currentBet=0,t.lastAction=null})}handleSinglePlayerWin(){const t=this.gameState.getPlayersInHand();if(1!==t.length)return;const e=t[0];this.gameState.calculateSidePots();const a=this.gameState.getTotalPot();e.winPot(a),this.gameState.winners=[{player:e,amount:a,handDescription:"Won by default (others folded)"}],this.completeHand()}handleShowdown(){this.gameState.phase=n.aA.SHOWDOWN,this.gameState.calculateSidePots();const t=this.gameState.getPlayersInHand().map(t=>({player:t,cards:[...t.holeCards,...this.gameState.communityCards]})),e=h.findWinners(t),a=this.gameState._internalPot.main,i=Math.floor(a/e.length);this.gameState.winners=[],e.forEach(t=>{let{player:e,hand:a}=t;e.winPot(i),this.gameState.winners.push({player:e,amount:i,hand:a,handDescription:a.description})});for(const s of this.gameState._internalPot.side){const e=t.filter(t=>{let{player:e}=t;return s.eligiblePlayers.includes(e)}),a=h.findWinners(e),i=Math.floor(s.amount/a.length);a.forEach(t=>{let{player:e,hand:a}=t;e.winPot(i);const s=this.gameState.winners.find(t=>t.player===e);s?s.amount+=i:this.gameState.winners.push({player:e,amount:i,hand:a,handDescription:a.description})})}this.callbacks.onShowdown&&this.callbacks.onShowdown(this.gameState.winners),this.completeHand()}completeHand(){this.callbacks.onHandComplete&&this.callbacks.onHandComplete(this.gameState.winners);const t=this.gameState.winners;return this.gameState.phase="waiting",this.notifyStateChange(),setTimeout(()=>{try{this.gameState.players.filter(t=>t.isActive&&t.chips>0).length>=2&&!this._isRestarting&&this.startNewHand()}catch(t){console.error("Failed to auto-start new hand:",t),this._isRestarting=!1}},3e3),{winners:t}}getValidActions(t){if(!this.gameState||!this.gameState.players)return console.warn("getValidActions: No game state or players"),[];const e=this.gameState.players.find(e=>e&&e.id===t);if(!e)return console.warn("getValidActions: Player '".concat(t,"' not found")),[];const a=this.getCurrentPlayer();if(!a)return console.warn("getValidActions: No current player"),[];if(a.id!==t)return[];try{return d.A.getValidActions(this.gameState,e)}catch(i){return console.error("getValidActions: Error getting valid actions:",i),[]}}getGameState(){return this.gameState.serialize()}notifyStateChange(){this.callbacks.onStateChange&&this.callbacks.onStateChange(this.getGameState())}notifyPhaseChange(){this.callbacks.onPhaseChange&&this.callbacks.onPhaseChange(this.gameState.phase)}setBlinds(t,e){this.gameState.blinds={small:t,big:e},this.gameState.minimumRaise=e}getPlayerCards(t){const e=this.gameState.players.find(e=>e.id===t);return e?e.holeCards:[]}getAllPlayerCards(){return this.gameState.players.map(t=>({playerId:t.id,cards:t.holeCards}))}getCommunityCards(){return[...this.gameState.communityCards]}getCurrentPlayer(){if(!this.gameState||!this.gameState.players||0===this.gameState.players.length)return;const t=this.gameState.currentPlayerIndex;if(t<0||t>=this.gameState.players.length)return void console.warn("Invalid currentPlayerIndex: ".concat(t,", players length: ").concat(this.gameState.players.length));const e=this.gameState.players[t];if(e)return e;console.warn("No player found at index: ".concat(t))}getPotOdds(t){const e=this.gameState.players.find(e=>e.id===t);return e?d.A.calculatePotOdds(this.gameState,e):0}};const m=class{constructor(t,e,a){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.id=t,this.name=e,this.chips=a,this.position=i,this._position=i,"string"===typeof s?(this.aiType=s,this.isAI=!0):(this.isAI=s,this.aiType=r||void 0),this.holeCards=[],this.cards=this.holeCards,this.status=n.PQ.WAITING,this._currentBet=0,this.totalBetThisRound=0,this.totalPotContribution=0,this.lastAction=null,this.isActive=!0,this.isFolded=!1,this.isAllIn=!1,this.isDealer=!1,this.stats={handsPlayed:0,handsWon:0,biggestPotWon:0,totalWinnings:0,vpip:0,pfr:0,aggression:0}}setHoleCards(t){this.holeCards=t,this.cards=this.holeCards}receiveCards(t){this.setHoleCards(t)}clearHoleCards(){this.holeCards=[],this.cards=this.holeCards}placeBet(t){if(t<0)throw new Error("Bet amount cannot be negative");if(t>this.chips)throw new Error("Insufficient chips");const e=Math.min(t,this.chips);return this.chips-=e,this._currentBet+=e,this.totalBetThisRound+=e,this.totalPotContribution+=e,0===this.chips&&(this.status=n.PQ.ALL_IN,this.isAllIn=!0),e}fold(){this.status=n.PQ.FOLDED,this.lastAction="fold",this.isFolded=!0,this.clearHoleCards()}check(){this.lastAction="check",this.status=n.PQ.CHECKED}call(t){const e=t>this.chips?this.chips:t,a=this.placeBet(e);return this.lastAction="call",0===this.chips?this.status=n.PQ.ALL_IN:this.status=n.PQ.CALLED,a}bet(t){const e=this.placeBet(t);return this.lastAction="bet",e}raise(t){if(t<=this._currentBet)throw new Error("Raise amount must be greater than current bet");const e=t-this._currentBet,a=this.placeBet(e);return this.lastAction="raise",this.status=n.PQ.RAISED,a}winPot(t){if(t<0)throw new Error("Win amount cannot be negative");this.chips+=t,this.stats.handsWon++,this.stats.totalWinnings+=t,t>this.stats.biggestPotWon&&(this.stats.biggestPotWon=t)}resetForNewHand(){this.clearHoleCards(),this.status=n.PQ.WAITING,this._currentBet=0,this.totalBetThisRound=0,this.totalPotContribution=0,this.lastAction=null,this.isActive=!0,this.isFolded=!1,this.isAllIn=!1,this.stats.handsPlayed++}resetBettingRound(){this._currentBet=0,this.totalBetThisRound=0,this.status!==n.PQ.FOLDED&&this.status!==n.PQ.ALL_IN&&(this.status=n.PQ.WAITING)}checkIfActive(){return this.status===n.PQ.ACTIVE||this.status===n.PQ.ALL_IN}canAct(){return this.isActive&&this.chips>0&&this.status!==n.PQ.FOLDED&&this.status!==n.PQ.ALL_IN}isInHand(){return this.isActive&&this.status!==n.PQ.FOLDED&&this.status!==n.PQ.SITTING_OUT}decideAction(t){if(!this.isAI)throw new Error("decideAction can only be called on AI players");const e=a(780).A,i=a(771).A.getValidActions(t,this);return e.getAction(this,t,i,{getPlayerCards:()=>this.holeCards,getCommunityCards:()=>t.communityCards})}toJSON(){return{id:this.id,name:this.name,chips:this.chips,_currentBet:this._currentBet,_position:this._position,cards:this.cards,isAI:this.isAI,aiType:this.aiType,status:this.status,isActive:this.isActive,isFolded:this.isFolded,isAllIn:this.isAllIn,isDealer:this.isDealer,totalBetThisRound:this.totalBetThisRound}}getNetPosition(){return this.chips-this.totalPotContribution}updateStats(t,e){"preflop"===e&&"fold"!==t&&this.stats.vpip++,"preflop"!==e||"bet"!==t&&"raise"!==t||this.stats.pfr++,"bet"!==t&&"raise"!==t||this.stats.aggression++}serialize(){return{id:this.id,name:this.name,chips:this.chips,position:this.position,isAI:this.isAI,aiType:this.aiType,status:this.status,currentBet:this._currentBet,lastAction:this.lastAction,hasCards:this.holeCards.length>0,holeCards:this.isAI?null:this.holeCards.map(t=>({rank:t.rank,suit:t.suit}))}}get currentBet(){return this._currentBet}set currentBet(t){this._currentBet=t}};var g=a(193);const p=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const{initialChips:a=1e4,smallBlind:l=50,bigBlind:o=100,aiPlayers:c=[{name:"Alex (TAG)",type:"tight-aggressive"},{name:"Sarah (LAG)",type:"loose-aggressive"},{name:"Mike (TP)",type:"tight-passive"},{name:"Lisa (LP)",type:"loose-passive"},{name:"John (TAG)",type:"tight-aggressive"}],onStateChange:h,onShowdown:d,onPhaseChange:p,onPlayerAction:y}=e,[f]=(0,i.useState)(()=>new u),[b,P]=(0,i.useState)(null),[v,A]=(0,i.useState)(!1),[S,C]=(0,i.useState)([]),[k,x]=(0,i.useState)(!1),[N,B]=(0,i.useState)(!1),[I,w]=(0,i.useState)(null),[R,j]=(0,i.useState)(!1),T=(0,i.useRef)(!1),_=(0,i.useRef)(f),H=(0,g.A)(),F=(0,i.useCallback)(()=>{const t=_.current,e=t.getGameState();if("waiting"===e.phase||"showdown"===e.phase)return!1;const a=t.getCurrentPlayer();if(!a||!a.isAI)return!1;if(!a.canAct())return!1;const i=t.getValidActions(a.id);if(!i||0===i.length)return!1;const s=r.A.getAction(a,e,i,t),n=t.executePlayerAction(a.id,s.action,s.amount);if(!n.success)return console.error("AI action failed:",n.error),!1;const l=t.getGameState();if("waiting"===l.phase||"showdown"===l.phase)return!1;const o=t.getCurrentPlayer();return o&&o.isAI&&o.canAct()},[]),O=(0,i.useCallback)(()=>{if(T.current)return;const t=_.current,e=t.getGameState();if("waiting"===e.phase||"showdown"===e.phase)return;const a=t.getCurrentPlayer();if(!a||!a.isAI||!a.canAct())return;T.current=!0,B(!0);const i=()=>{try{F()?setTimeout(i,800):(T.current=!1,B(!1))}catch(t){console.error("AI processing error:",t),w("AI action failed: ".concat(t.message)),T.current=!1,B(!1)}};setTimeout(i,800)},[F]),E=(0,i.useCallback)(()=>{try{const e=_.current;if(e._isInitialized)return;e._isInitialized=!0;const i=new m(t,"You",a,0,!1);e.addPlayer(i),c.forEach((t,i)=>{const s=new m("ai-".concat(i+1),t.name,a,i+1,!0,t.type);e.addPlayer(s)}),e.setBlinds(l,o),setTimeout(()=>{try{j(!0),e.startNewHand()}catch(t){w("Failed to start new hand: ".concat(t.message)),e._isInitialized=!1,j(!1)}},1e3)}catch(e){w("Failed to initialize game: ".concat(e.message)),_.current._isInitialized=!1}},[t,a,l,o,c]);(0,i.useEffect)(()=>{const e=_.current;e._callbacksInitialized||(e._callbacksInitialized=!0,e.setCallback("onStateChange",a=>{const i=(0,s.A)((0,s.A)({},a),{},{_updateTimestamp:Date.now()});P(i),w(null);const n=e.getCurrentPlayer();if(n&&n.id===t){const a=e.getValidActions(t);C(a),A(!0)}else A(!1),C([]);h&&h(a)}),e.setCallback("onShowdown",t=>{x(!0),setTimeout(()=>x(!1),5e3),d&&d(t)}),e.setCallback("onPhaseChange",t=>{t!==n.aA.SHOWDOWN&&x(!1),p&&p(t)}),e.setCallback("onPlayerAction",(t,e,a)=>{R&&H.isSessionActive&&H.captureAction(t.id,e,a),y&&y(t,e,a)}),E())},[t,E]);const L=(0,i.useCallback)((e,a)=>{try{w(null);const i=_.current,s=i.executePlayerAction(t,e,a);if(!s.success)return void w("Action failed: ".concat(s.error));T.current=!1,setTimeout(()=>{const t=i.getCurrentPlayer();t&&t.isAI&&t.canAct()&&O()},600)}catch(i){w("Action failed: ".concat(i.message))}},[t,O]),D=(0,i.useMemo)(()=>{if(!b||!b.players||0===b.players.length)return{humanPlayer:null,currentPlayer:null,isHumanTurn:!1};const e=b.players.find(e=>e&&e.id===t),a=b.currentPlayerIndex>=0&&b.currentPlayerIndex<b.players.length?b.players[b.currentPlayerIndex]:null;return{humanPlayer:e,currentPlayer:a,isHumanTurn:a&&e&&a.id===e.id}},[b,t]);return(0,i.useEffect)(()=>{if(!b)return;if(T.current)return;if("waiting"===b.phase||"showdown"===b.phase)return;const t=_.current,e=t.getCurrentPlayer();if(e&&e.isAI&&e.canAct()){const e=setTimeout(()=>{if(!T.current){const e=t.getCurrentPlayer();e&&e.isAI&&e.canAct()&&O()}},150);return()=>clearTimeout(e)}},[b,O]),{gameState:b,showControls:v,validActions:S,showdown:k,isProcessingAI:N,error:I,isGameActive:R,executeAction:L,getCurrentPlayerInfo:D,gameEngine:f,humanPlayerId:t,handHistory:H}};var y=a(579);const f=i.memo(t=>{let{validActions:e,_currentBet:a,playerChips:s,playerBet:n,_pot:r,onAction:l,minBet:o,minRaise:c}=t;const h=Math.max(0,(a||0)-(n||0)),[d,u]=(0,i.useState)(o||c||0);(0,i.useEffect)(()=>{e.includes("bet")?u(o):e.includes("raise")&&u(c)},[e,o,c]);const m=(0,i.useCallback)(t=>{u(parseInt(t.target.value))},[]),g=(0,i.useCallback)(t=>{const e=parseInt(t.target.value)||0;u(Math.min(e,s))},[s]),p=(0,i.useCallback)(t=>{let a;a="all"===t?s||0:Math.floor((r||0)*t),e.includes("bet")?a=Math.max(a,o||0):e.includes("raise")&&(a=Math.max(a,c||0)),u(Math.min(a,s||0))},[r,s,o,c,e]),f=(()=>{if(0===h)return null;const t=(r||0)+h;if(0===t)return null;return(h/t*100).toFixed(1)})();return(0,y.jsxs)("div",{className:"betting-controls",role:"region","aria-label":"Betting controls","aria-describedby":"betting-info pot-odds",children:[(0,y.jsxs)("div",{className:"betting-info",id:"betting-info",role:"group","aria-label":"Game information",children:[(0,y.jsxs)("div",{className:"betting-info-item",children:[(0,y.jsx)("span",{className:"betting-info-label",children:"Pot"}),(0,y.jsxs)("span",{className:"betting-info-value",children:["$",r||0]})]}),(0,y.jsxs)("div",{className:"betting-info-item",children:[(0,y.jsx)("span",{className:"betting-info-label",children:"To Call"}),(0,y.jsxs)("span",{className:"betting-info-value",children:["$",h||0]})]}),(0,y.jsxs)("div",{className:"betting-info-item",children:[(0,y.jsx)("span",{className:"betting-info-label",children:"Your Stack"}),(0,y.jsxs)("span",{className:"betting-info-value",children:["$",s||0]})]})]}),(e.includes("bet")||e.includes("raise"))&&(0,y.jsxs)("div",{className:"betting-slider-container",role:"group","aria-label":"Bet amount controls",children:[(0,y.jsxs)("div",{className:"bet-amount-display",children:[(0,y.jsx)("label",{htmlFor:"bet-amount-input",className:"bet-amount-label",children:e.includes("bet")?"Bet Amount:":"Raise To:"}),(0,y.jsx)("input",{id:"bet-amount-input",type:"number",className:"bet-amount-input",value:d,onChange:g,min:e.includes("bet")?o:c,max:s,"aria-describedby":"bet-range-slider","aria-label":"".concat(e.includes("bet")?"Bet":"Raise"," amount in dollars")})]}),(0,y.jsx)("input",{id:"bet-range-slider",type:"range",className:"betting-slider",min:e.includes("bet")?o:c,max:s,value:d,onChange:m,"aria-label":"Adjust ".concat(e.includes("bet")?"bet":"raise"," amount with slider"),"aria-valuemin":e.includes("bet")?o:c,"aria-valuemax":s,"aria-valuenow":d,"aria-valuetext":"$".concat(d)}),(0,y.jsxs)("div",{className:"preset-buttons",role:"group","aria-label":"Preset bet amounts",children:[(0,y.jsx)("button",{className:"preset-button",onClick:()=>p(1/3),"aria-label":"Set bet to one third of pot: $".concat(Math.floor((r||0)/3)),children:"1/3 Pot"}),(0,y.jsx)("button",{className:"preset-button",onClick:()=>p(.5),"aria-label":"Set bet to half of pot: $".concat(Math.floor((r||0)/2)),children:"1/2 Pot"}),(0,y.jsx)("button",{className:"preset-button",onClick:()=>p(1),"aria-label":"Set bet to full pot: $".concat(r||0),children:"Pot"}),(0,y.jsx)("button",{className:"preset-button",onClick:()=>p("all"),"aria-label":"Go all in with all chips: $".concat(s),children:"All In"})]})]}),(0,y.jsxs)("div",{className:"action-buttons",role:"group","aria-label":"Poker action buttons",children:[e.includes("fold")&&(0,y.jsx)("button",{className:"action-button fold",onClick:()=>l("fold"),"aria-label":"Fold your hand and forfeit this round","aria-describedby":"betting-info",children:"Fold"}),e.includes("check")&&(0,y.jsx)("button",{className:"action-button check",onClick:()=>l("check"),"aria-label":"Check - no bet required","aria-describedby":"betting-info",children:"Check"}),e.includes("call")&&(0,y.jsxs)("button",{className:"action-button call",onClick:()=>l("call",h),"aria-label":"Call the current bet of $".concat(h||0),"aria-describedby":"betting-info",children:["Call $",h||0]}),e.includes("bet")&&(0,y.jsxs)("button",{className:"action-button bet",onClick:()=>l("bet",d),disabled:d<o||d>s,"aria-label":"Bet $".concat(d),"aria-describedby":"betting-info bet-amount-input","aria-disabled":d<o||d>s,children:["Bet $",d]}),e.includes("raise")&&(0,y.jsxs)("button",{className:"action-button raise",onClick:()=>l("raise",d),disabled:d<c||d>s,"aria-label":"Raise the bet to $".concat(d),"aria-describedby":"betting-info bet-amount-input","aria-disabled":d<c||d>s,children:["Raise to $",d]}),e.includes("all-in")&&(0,y.jsxs)("button",{className:"action-button all-in",onClick:()=>l("all-in",s),"aria-label":"Go all in with all your chips: $".concat(s),"aria-describedby":"betting-info",children:["All In $",s]})]}),f&&(0,y.jsxs)("div",{className:"pot-odds-display",id:"pot-odds",role:"status","aria-live":"polite","aria-label":"Pot odds: ".concat(f,"% ").concat(parseFloat(f)<30?"This is a good betting opportunity":""),children:["Pot Odds: ",f,"%",parseFloat(f)<30&&(0,y.jsxs)("span",{className:"pot-odds-good","aria-label":"Good betting odds",children:[" ","(Good)"]})]})]})},(t,e)=>JSON.stringify(t.validActions)===JSON.stringify(e.validActions)&&t._currentBet===e._currentBet&&t.playerChips===e.playerChips&&t.playerBet===e.playerBet&&t._pot===e._pot&&t.minBet===e.minBet&&t.minRaise===e.minRaise&&t.onAction===e.onAction);f.displayName="BettingControls";const b=f,P=i.memo(t=>{let{card:e,size:a="normal",faceDown:i=!1}=t;if(!e&&!i)return(0,y.jsx)("div",{className:"card-placeholder","aria-label":"Empty card slot",role:"img"});if(i)return(0,y.jsx)("div",{className:"playing-card back ".concat(a),role:"img","aria-label":"Face-down playing card"});const s={s:"spades",h:"hearts",d:"diamonds",c:"clubs"}[e.suit]||"";const n=(t=>({s:"\u2660",h:"\u2665",d:"\u2666",c:"\u2663"}[t]||""))(e.suit);return(0,y.jsxs)("div",{className:"playing-card ".concat(s," ").concat(a),role:"img","aria-label":(()=>{const t=(t=>({s:"spades",h:"hearts",d:"diamonds",c:"clubs"}[t]||""))(e.suit);return"".concat(e.rank," of ").concat(t)})(),children:[(0,y.jsxs)("div",{className:"card-corner top-left",children:[(0,y.jsx)("span",{children:e.rank}),(0,y.jsx)("span",{className:"card-corner-suit",children:n})]}),(0,y.jsxs)("div",{className:"card-center",children:[(0,y.jsx)("div",{className:"card-rank",children:e.rank}),(0,y.jsx)("div",{className:"card-suit",children:n})]}),(0,y.jsxs)("div",{className:"card-corner bottom-right",children:[(0,y.jsx)("span",{children:e.rank}),(0,y.jsx)("span",{className:"card-corner-suit",children:n})]})]})},(t,e)=>{var a,i,s,n;return t.size===e.size&&t.faceDown===e.faceDown&&(null===(a=t.card)||void 0===a?void 0:a.rank)===(null===(i=e.card)||void 0===i?void 0:i.rank)&&(null===(s=t.card)||void 0===s?void 0:s.suit)===(null===(n=e.card)||void 0===n?void 0:n.suit)});P.displayName="Card";const v=P,A=i.memo(t=>{let{player:e,isActive:a,isDealer:i,position:s,showCards:n}=t;if(!e)return null;const r=(()=>{if(i)return"BTN";return{"small-blind":"SB","big-blind":"BB","under-the-gun":"UTG","middle-position":"MP","cut-off":"CO"}[s]||""})(),l=["player-seat","position-".concat(e.position),a?"active":"","folded"===e.status?"folded":""].filter(Boolean).join(" ");return(0,y.jsxs)("div",{className:l,children:[r&&(0,y.jsx)("div",{className:"position-label",children:r}),"all-in"===e.status&&(0,y.jsx)("div",{className:"player-status-icon",children:"AI"}),(0,y.jsxs)("div",{className:"player-info",children:[(0,y.jsx)("span",{className:"player-name",children:e.name}),(0,y.jsxs)("span",{className:"player-chips",children:["$",(o=e.chips,o>=1e6?"".concat((o/1e6).toFixed(1),"M"):o>=1e3?"".concat((o/1e3).toFixed(1),"K"):o.toString())]})]}),(0,y.jsx)("div",{className:"player-cards",children:e.holeCards&&e.holeCards.length>0&&"folded"!==e.status?(0,y.jsx)(y.Fragment,{children:n&&e.holeCards?e.holeCards.map((t,e)=>(0,y.jsx)(v,{card:t,size:"small"},e)):(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v,{faceDown:!0,size:"small"}),(0,y.jsx)(v,{faceDown:!0,size:"small"})]})}):null}),e.currentBet>0&&(0,y.jsxs)("div",{className:"player-bet",children:["$",e.currentBet]}),e.lastAction&&(0,y.jsx)("div",{className:"player-_action ".concat(e.lastAction),children:e.lastAction}),a&&(0,y.jsx)("div",{className:"player-timer",children:(0,y.jsx)("div",{className:"player-timer-bar",style:{width:"100%"}})})]});var o},(t,e)=>{const a=t.player,i=e.player;return!a&&!i||!(!a||!i)&&(t.isActive===e.isActive&&t.isDealer===e.isDealer&&t.position===e.position&&t.showCards===e.showCards&&a.id===i.id&&a.name===i.name&&a.chips===i.chips&&a.status===i.status&&a.currentBet===i.currentBet&&a.lastAction===i.lastAction&&a.hasCards===i.hasCards&&JSON.stringify(a.holeCards)===JSON.stringify(i.holeCards))});A.displayName="PlayerSeat";const S=A,C=function(){let{onGameStateChange:t,onPlayerAction:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const a="human-player",{gameState:s,showControls:n,validActions:r,showdown:l,error:o,isProcessingAI:c,executeAction:h,getCurrentPlayerInfo:d,gameEngine:u}=p(a,{onStateChange:t,onPlayerAction:e}),[m,g]=(0,i.useState)(3),f="waiting"===(null===s||void 0===s?void 0:s.phase);(0,i.useEffect)(()=>{if(f){g(3);const t=setInterval(()=>{g(e=>e<=1?(clearInterval(t),0):e-1)},1e3);return()=>clearInterval(t)}},[f]);if(!s)return(0,y.jsx)("div",{className:"poker-table-container",children:(0,y.jsx)("div",{className:"loading",children:"Loading game..."})});const{humanPlayer:P,isHumanTurn:A,currentPlayer:C}=d,k="showdown"===s.phase,x=n&&P&&A&&!f;return(0,y.jsxs)("div",{className:"poker-table-container",children:[o&&(0,y.jsx)("div",{className:"error-banner",role:"alert","aria-live":"assertive","aria-atomic":"true",children:o}),(0,y.jsxs)("main",{className:"poker-table",role:"main","aria-label":"Poker game table",children:[(0,y.jsx)("div",{className:"table-rail"}),(0,y.jsx)("section",{className:"player-seats","aria-label":"Player seating positions",children:s.players&&s.players.filter(t=>null!=t).map(t=>(0,y.jsx)(S,{player:t,isActive:s.currentPlayerIndex===t.position,isDealer:s.dealerPosition===t.position,showCards:t.id===a||l},t.id))}),(0,y.jsxs)("section",{className:"community-cards","aria-label":"Community cards","aria-describedby":"game-phase-indicator",children:[s.communityCards&&s.communityCards.map((t,e)=>(0,y.jsx)(v,{card:t},"card-".concat(t.rank,"-").concat(t.suit,"-").concat(e))),(()=>{const t=s.communityCards?s.communityCards.length:0,e=Math.max(0,5-t);return[...Array(e)].map((t,e)=>(0,y.jsx)(v,{},"placeholder-".concat(e)))})()]}),(0,y.jsxs)("div",{className:"pot-display",role:"status","aria-live":"polite","aria-label":"Current pot amount: $".concat(s._pot||0),children:["Pot: $",s._pot||0]}),(0,y.jsxs)("aside",{className:"game-info","aria-label":"Game information",children:[(0,y.jsx)("h3",{children:"Game Info"}),(0,y.jsxs)("div",{className:"game-info-item",children:[(0,y.jsx)("span",{children:"Hand #"}),(0,y.jsx)("span",{"aria-label":"Hand number ".concat(s.handNumber),children:s.handNumber})]}),(0,y.jsxs)("div",{className:"game-info-item",children:[(0,y.jsx)("span",{children:"Blinds"}),(0,y.jsxs)("span",{"aria-label":"Small blind $".concat(s.blinds.small,", big blind $").concat(s.blinds.big),children:["$",s.blinds.small,"/$",s.blinds.big]})]}),(0,y.jsxs)("div",{className:"game-info-item",children:[(0,y.jsx)("span",{children:"Players"}),(0,y.jsx)("span",{"aria-label":"".concat(s.getPlayersInHand?s.getPlayersInHand().length:s.players.length," players in game"),children:s.getPlayersInHand?s.getPlayersInHand().length:s.players.length})]})]}),(0,y.jsx)("div",{id:"game-phase-indicator",className:"phase-indicator",role:"status","aria-live":"polite","aria-label":"Current game phase: ".concat(s.phase),children:s.phase}),l&&s.winners&&s.winners.length>0&&(0,y.jsxs)("section",{className:"winners-display",role:"status","aria-live":"assertive","aria-label":"Hand results",children:[(0,y.jsxs)("h2",{children:["Winner",s.winners.length>1?"s":"","!"]}),s.winners.map((t,e)=>(0,y.jsxs)("div",{className:"winner-item","aria-label":"".concat(t.player.name," wins $").concat(t.amount," with ").concat(t.handDescription),children:[(0,y.jsxs)("div",{children:[t.player.name," wins $",t.amount]}),(0,y.jsx)("div",{className:"winner-hand",children:t.handDescription})]},e))]}),(0,y.jsx)("div",{className:"dealer-button",style:{transform:"translate(-50%, -50%)\n                     rotate(".concat(s.dealerPosition*(360/s.players.length),"deg)\n                     translateX(200px)")},role:"img","aria-label":"Dealer button at position ".concat(s.dealerPosition+1),children:"D"})]}),(0,y.jsxs)("div",{className:"game-status-panel",role:"status","aria-live":"polite",children:[f&&(0,y.jsxs)("div",{className:"status-waiting",children:[(0,y.jsxs)("p",{children:["Hand complete. Next hand in ",m,"..."]}),(0,y.jsx)("button",{className:"new-hand-button",onClick:()=>{try{u&&u.startNewHand()}catch(t){console.error("Failed to start new hand:",t)}},children:"Start Now"})]}),c&&!f&&!k&&(0,y.jsxs)("div",{className:"status-ai-thinking",children:[(0,y.jsxs)("div",{className:"thinking-indicator",children:[(0,y.jsx)("span",{className:"dot"}),(0,y.jsx)("span",{className:"dot"}),(0,y.jsx)("span",{className:"dot"})]}),(0,y.jsxs)("p",{children:[(null===C||void 0===C?void 0:C.name)||"AI"," is thinking..."]})]}),!f&&!c&&!A&&!k&&C&&(0,y.jsx)("div",{className:"status-other-turn",children:(0,y.jsxs)("p",{children:["Waiting for ",C.name,"..."]})}),A&&!f&&!k&&(0,y.jsx)("div",{className:"status-your-turn",children:(0,y.jsx)("p",{children:"Your turn to act!"})})]}),x&&(0,y.jsx)(b,{validActions:r,_currentBet:s.currentBet,playerChips:P.chips,playerBet:P.currentBet,_pot:s._pot||0,minBet:s.blinds.big,minRaise:s.currentBet+s.minimumRaise,onAction:h})]})}},771(t,e,a){a.d(e,{A:()=>s});var i=a(442);const s=class{static validateAction(t,e,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(!e.canAct())return{valid:!1,reason:"Player cannot act"};const n=t.currentBet-e.currentBet;switch(a){case i.y6.FOLD:return{valid:!0};case i.y6.CHECK:return n>0?{valid:!1,reason:"Cannot check when there is a bet to call"}:{valid:!0};case i.y6.CALL:return 0===n?{valid:!1,reason:"Nothing to call"}:{valid:!0,amount:Math.min(n,e.chips)};case i.y6.BET:return t.currentBet>0?{valid:!1,reason:"Cannot bet when there is already a bet"}:s<t.blinds.big?{valid:!1,reason:"Bet must be at least the big blind"}:s>e.chips?{valid:!1,reason:"Not enough chips"}:{valid:!0,amount:s};case i.y6.RAISE:{if(0===t.currentBet)return{valid:!1,reason:"Cannot raise when there is no bet"};const a=t.currentBet+t.minimumRaise;return s<a&&s<e.chips?{valid:!1,reason:"Raise must be at least ".concat(a)}:s>e.chips?{valid:!1,reason:"Not enough chips"}:{valid:!0,amount:Math.min(s,e.chips)}}case i.y6.ALL_IN:return{valid:!0,amount:e.chips};default:return{valid:!1,reason:"Invalid _action"}}}static getValidActions(t,e){if(!e.canAct())return[];const a=[],s=t.currentBet-e.currentBet;if(a.push(i.y6.FOLD),0===s)a.push(i.y6.CHECK),e.chips>=t.blinds.big&&a.push(i.y6.BET);else{e.chips>=s&&a.push(i.y6.CALL);const n=t.currentBet+t.minimumRaise;e.chips>=n&&a.push(i.y6.RAISE)}return e.chips>0&&(s>0||0===t.currentBet)&&!a.includes(i.y6.CALL)&&!a.includes(i.y6.RAISE)&&a.push(i.y6.ALL_IN),a}static executeAction(t,e,a){let s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;const n=this.validateAction(t,e,a,s);if(!n.valid)throw new Error(n.reason);const r=e.currentBet;switch(a){case i.y6.FOLD:e.fold();break;case i.y6.CHECK:e.check();break;case i.y6.CALL:{const a=n.amount||t.currentBet-e.currentBet,i=Math.min(a,e.chips);e.call(i),t.potObject.main+=i;break}case i.y6.BET:e.bet(n.amount),t.currentBet=n.amount,t.minimumRaise=n.amount,t.potObject.main+=n.amount,t.lastRaiserIndex=e.position;break;case i.y6.RAISE:{const a=n.amount,i=a-e.currentBet;e.raise(a),t.minimumRaise=a-t.currentBet,t.currentBet=a,t.potObject.main+=i,t.lastRaiserIndex=e.position;break}case i.y6.ALL_IN:{const a=e.chips;if(0===t.currentBet)e.bet(a),a>=t.blinds.big&&(t.currentBet=a,t.minimumRaise=a,t.lastRaiserIndex=e.position);else if(e.currentBet+a>t.currentBet){e.raise(a);const i=r+a;i>=t.currentBet+t.minimumRaise&&(t.minimumRaise=i-t.currentBet,t.currentBet=i,t.lastRaiserIndex=e.position)}else e.call(a);e.status="all-in",e.lastAction="all-in",t.potObject.main+=a;break}}t.handHistory.push({playerId:e.id,playerName:e.name,_action:a,amount:n.amount||0,potAfter:t.getTotalPot(),phase:t.phase,handNumber:t.handNumber,timestamp:Date.now()})}static isBettingRoundComplete(t){const e=t.players.filter(t=>t.canAct());if(e.length<=1)return!0;const a=e.every(t=>null!==t.lastAction),i=e.every(e=>e.currentBet===t.currentBet);if("preflop"===t.phase&&null===t.lastRaiserIndex&&t.currentBet===t.blinds.big){const e=t.getBigBlindPosition(),a=t.getPlayerByPosition(e);if(a&&a.canAct()&&!a.lastAction)return!1}if(null!==t.lastRaiserIndex)for(const s of e)if(s.position!==t.lastRaiserIndex&&!this.hasActedSinceLastRaise(t,s))return!1;return a&&i}static hasActedSinceLastRaise(t,e){const a=t.handHistory;let s=-1;for(let n=a.length-1;n>=0;n--){const t=a[n]._action||a[n].action;if(t===i.y6.RAISE||t===i.y6.BET){s=n;break}}return-1===s||a.slice(s+1).some(t=>t.playerId===e.id)}static calculateMinBet(t){return t.blinds.big}static calculateMinRaise(t){return t.currentBet+t.minimumRaise}static calculatePotOdds(t,e){const a=t.currentBet-e.currentBet;if(a<=0)return 100;return a/(t.getTotalPot()+a)*100}static getBettingRoundSummary(t){var e;const a=t.getPlayersInHand();return{_pot:t.getTotalPot(),toCall:t.currentBet,playersRemaining:a.length,currentPlayer:(null===(e=t.players[t.currentPlayerIndex])||void 0===e?void 0:e.name)||"None",phase:t.phase}}}},780(t,e,a){a.d(e,{A:()=>d});var i=a(442);const s={early:{openRange:.12,threeBetRange:.05,callRange:.08,premiumThreshold:.85,strongThreshold:.7,playableThreshold:.5},middle:{openRange:.18,threeBetRange:.07,callRange:.12,premiumThreshold:.8,strongThreshold:.65,playableThreshold:.45},late:{openRange:.28,threeBetRange:.1,callRange:.18,premiumThreshold:.75,strongThreshold:.55,playableThreshold:.35},button:{openRange:.38,threeBetRange:.12,callRange:.25,premiumThreshold:.7,strongThreshold:.5,playableThreshold:.3},blinds:{openRange:.25,threeBetRange:.08,callRange:.3,premiumThreshold:.75,strongThreshold:.55,playableThreshold:.35,defendRange:.4}},n=.45,r=.35,l=.25,o=.4,c=.25;const h=class{static getPosition(t,e,a){const i=(t-e+a)%a;if(2===a)return 0===i?"button":"blinds";if(0===i)return"button";if(1===i||2===i)return"blinds";const s=a-3;if(s<=3)return 3===i?"late":"middle";const n=Math.ceil(s/3),r=i-3;return r<n?"early":r<2*n?"middle":"late"}static getRangeForPosition(t){return s[t]||s.middle}static adjustStrengthForPosition(t,e){if(!(!(arguments.length>2&&void 0!==arguments[2])||arguments[2])){const a={early:.95,middle:1,late:1.05,button:1.1,blinds:.95}[e]||1;return Math.min(t*a,1)}const a={early:.85,middle:.92,late:1.05,button:1.15,blinds:.95}[e]||1;return Math.min(t*a,1)}static isPlayableFromPosition(t,e){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const i=this.getRangeForPosition(e);return a?t>=3*i.callRange:t>=i.playableThreshold}static shouldOpenRaise(t,e){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"TAG";const i=this.getRangeForPosition(e),s={TAG:1,LAG:1.3,TP:.8,LP:1.2}[a]||1;return t>=i.strongThreshold/s}static getStealFrequency(t){return{button:n,late:r,middle:l}[t]||0}static getBlindDefenseFrequency(t){return t?c:o}static adjustBetSizeForPosition(t,e){const a={early:1.2,middle:1.1,late:1,button:.9,blinds:1.1}[e]||1;return Math.floor(t*a)}};const d=class{static getAction(t,e,a,s){const{aiType:n}=t,r=s.getPlayerCards(t.id),l=s.getCommunityCards(),o="preflop"===e.phase,c=h.getPosition(t.position,e.dealerPosition,e.players.length),d=this.evaluateHandStrength(r,l,e.phase),u=h.adjustStrengthForPosition(d,c,o),m={handStrength:u,baseStrength:d,positionType:c,isPreflop:o,isInPosition:"button"===c||"late"===c,facingRaise:e.currentBet>e.blinds.big};switch(n){case i.$y.TAG:return this.getTightAggressiveAction(u,a,e,t,m);case i.$y.LAG:return this.getLooseAggressiveAction(u,a,e,t,m);case i.$y.TP:return this.getTightPassiveAction(u,a,e,t,m);case i.$y.LP:return this.getLoosePassiveAction(u,a,e,t,m);default:return this.getDefaultAction(a,e,t)}}static evaluateHandStrength(t,e,a){if(!t||t.length<2)return 0;const[i,s]=t,n=i.rank===s.rank,r=i.suit===s.suit,l=Math.max(i.value,s.value),o=Math.min(i.value,s.value),c=l-o;if("preflop"===a){if(n)return l>=12?.9:l>=9?.7:.5;if(14===l){if(o>=11)return.8;if(o>=9)return.6}return 13===l&&o>=11?.6:r&&c<=4?.4:c<=2&&l>=10?.3:.2}return this.calculatePostFlopStrength(t,e)}static calculatePostFlopStrength(t,e){if(0===e.length)return.3;const a=[...t,...e],i=this.hasTopPair(t,e),s=this.hasTwoPair(a),n=this.hasSet(t,e),r=this.hasFlushDraw(a),l=this.hasStraightDraw(a);return n?.9:s?.75:i?.65:r&&l?.55:r||l?.45:.25}static hasTopPair(t,e){if(0===e.length)return!1;const a=Math.max(...e.map(t=>t.value));return t.some(t=>t.value===a)}static hasTwoPair(t){const e={};t.forEach(t=>{e[t.rank]=(e[t.rank]||0)+1});return Object.values(e).filter(t=>t>=2).length>=2}static hasSet(t,e){return t[0].rank===t[1].rank&&e.some(e=>e.rank===t[0].rank)}static hasFlushDraw(t){const e={};return t.forEach(t=>{e[t.suit]=(e[t.suit]||0)+1}),Object.values(e).some(t=>t>=4)}static hasStraightDraw(t){const e=[...new Set(t.map(t=>t.value))].sort((t,e)=>t-e);for(let a=0;a<=e.length-4;a++){let t=1;for(let i=a;i<a+4&&i<e.length-1;i++)e[i+1]-e[i]===1&&t++;if(t>=4)return!0}return!1}static getTightAggressiveAction(t,e,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const n=a.currentBet-i.currentBet,r=a.totalPot||0,l=i.chips,{positionType:o="middle",isInPosition:c=!1}=s,d=c?.35:.4,u=c?.4:.3;if(t>=(c?.6:.7)){if(e.includes("raise")){const t=a.currentBet+a.minimumRaise+.75*(r||100),e=h.adjustBetSizeForPosition(Math.min(t,l),o);return{action:"raise",amount:Math.floor(e)}}if(e.includes("bet")){var m;const t=Math.max(.75*(r||100),(null===(m=a.blinds)||void 0===m?void 0:m.big)||20),e=h.adjustBetSizeForPosition(Math.min(t,l),o);return{action:"bet",amount:Math.floor(e)}}}if(t>=d){if(e.includes("call")&&n<=(r||100)*u)return{action:"call",amount:n};if(e.includes("check"))return{action:"check",amount:0}}return e.includes("check")?{action:"check",amount:0}:{action:"fold",amount:0}}static getLooseAggressiveAction(t,e,a,i){var s;let n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r=a.currentBet-i.currentBet,l=a.totalPot||0,o=i.chips,{positionType:c="middle",isInPosition:d=!1,isPreflop:u=!0}=n,m=d?.42:.3,g=h.getStealFrequency(c),p=d?.35:.5,y=d?.15:.25;if(u&&d&&a.currentBet===(null===(s=a.blinds)||void 0===s?void 0:s.big)&&Math.random()<g&&e.includes("raise")){const t=Math.min(3*a.currentBet,o);return{action:"raise",amount:Math.floor(t)}}if(t>=p||Math.random()<m){if(e.includes("raise")){const t=a.currentBet+a.minimumRaise+.5*(l||100),e=h.adjustBetSizeForPosition(Math.min(t,o),c);return{action:"raise",amount:Math.floor(e)}}if(e.includes("bet")){var f;const t=Math.max(.6*(l||100),(null===(f=a.blinds)||void 0===f?void 0:f.big)||20),e=h.adjustBetSizeForPosition(Math.min(t,o),c);return{action:"bet",amount:Math.floor(e)}}}if(t>=y){if(e.includes("call")&&r<=.5*(l||100))return{action:"call",amount:r};if(e.includes("check"))return{action:"check",amount:0}}return e.includes("check")?{action:"check",amount:0}:{action:"fold",amount:0}}static getTightPassiveAction(t,e,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const n=a.currentBet-i.currentBet,r=a.totalPot||0,l=i.chips,{isInPosition:o=!1}=s,c=o?.45:.5,h=o?.25:.2;if(t>=(o?.75:.8)){if(e.includes("bet")){var d;const t=Math.min(Math.max(.3*(r||100),(null===(d=a.blinds)||void 0===d?void 0:d.big)||20),l);return{action:"bet",amount:Math.floor(t)}}if(e.includes("call"))return{action:"call",amount:n}}if(t>=c){if(e.includes("call")&&n<=(r||100)*h)return{action:"call",amount:n};if(e.includes("check"))return{action:"check",amount:0}}return e.includes("check")?{action:"check",amount:0}:{action:"fold",amount:0}}static getLoosePassiveAction(t,e,a,i){let s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const n=a.currentBet-i.currentBet,r=a.totalPot||0,l=i.chips,{isInPosition:o=!1}=s,c=o?.15:.2,h=o?.5:.4;if(t>=(o?.65:.7)&&e.includes("bet")){var d;const t=Math.min(Math.max(.25*(r||100),(null===(d=a.blinds)||void 0===d?void 0:d.big)||20),l);return{action:"bet",amount:Math.floor(t)}}if(t>=c){if(e.includes("call")&&n<=(r||100)*h)return{action:"call",amount:n};if(e.includes("check"))return{action:"check",amount:0}}return e.includes("check")?{action:"check",amount:0}:{action:"fold",amount:0}}static getDefaultAction(t,e,a){if(t.includes("check"))return{action:"check",amount:0};const i=e.currentBet-a.currentBet,s=e.totalPot/i;return t.includes("call")&&s>3?{action:"call",amount:i}:{action:"fold",amount:0}}}}}]);
//# sourceMappingURL=poker-game.1f77de8b.chunk.js.map